@model ProductViewer.WebUI.Models.ProductViewModel

<style>
    .modal {
        width: 95% !important;
        height: 100% !important;
    }
</style>

<!-- Modal Structure -->
<div id="modal1" class="modal modal-fixed-footer">
    <div class="modal-content">

    </div>
    <div class="modal-footer" style="margin: 1em 1em 1em 0">
        <a onclick="" class="modal-close waves-effect waves-light btn-large"><i class="material-icons left">cancel</i>Cancel</a>
        <a onclick="sendInfo()" class="modal-close waves-effect waves-light btn-large"><i class="material-icons left">send</i>Submit</a>
    </div>
</div>

<div class="container">
    <div class="row card" style="background-color: #fafafa">
        <a style="margin: 1em" onclick="history.back()" class="modal-close card-title waves-effect waves-light btn-flat"><i class="material-icons left">arrow_back</i>Back</a>
    </div>
    <div class="row" style="margin-top: 0em">
        <div class="col s12">
            <div class="card">
                <div class="card-image">
                    <img class="materialboxed" data-caption="@Model.ProductDescriptionEntityDescription" src="/images/placeholder.gif">
                    <span class="card-title">@Model.ProductEntityName</span>
                    <a onclick="addToCart()" data-position="right" data-tooltip="Add to cart..." class="btn-floating btn-large halfway-fab waves-effect waves-light green tooltipped"><i class="material-icons">add</i></a>
                    <a onclick="editProduct()" data-position="top" data-tooltip="Edit product..." style="margin-right: 5em" class="btn-floating halfway-fab waves-effect waves-light orange tooltipped"><i class="material-icons">edit</i></a>
                    <a onclick="deleteProduct()" data-position="left" data-tooltip="Delete product..." style="margin-right: 9em" class="btn-floating halfway-fab waves-effect waves-light red tooltipped"><i class="material-icons">delete</i></a>
                </div>

                <div class="card-content">
                    <p>I am a very simple card. I am good at containing small bits of information. I am convenient because I require little markup to use effectively.</p>
                </div>

            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function(){
        $('.tooltipped').tooltip();
        $('.materialboxed').materialbox();
        $(".modal").modal({
            onCloseEnd: function () {
                M.toast({ html: '<p><i class=\'material-icons right\'>cancel</i>Action cancelled</p>' });
            }
        });
    });
    function editProduct() {
        var url = "@Url.Action("AddOrEditProduct", new{isEditing = true, id = @Model.ProductEntityId })";
        $.ajax({
            url: url,
            cache: false,
            type: "GET",
            success: function (result) {

                $('.modal-content').html(result);
                /* little fade in effect */
                $('.modal-content').fadeIn('fast');
                window.M.updateTextFields();
            },
            error: function (reponse) {
                alert("error : " + reponse);
            }
        });
        $("#modal1").modal('open');
    }
    function deleteProduct() {
        let text = $(`#${@Model.ProductEntityId}`).text();
        const confirmation = confirm(`Are you sure? Deleting ${text}...`);
        if (confirmation) {
            text = `/Home/RemoveItem/${@Model.ProductEntityId}`;
            location.href = text;
            M.toast({ html: '<p><i class=\'material-icons right\'>delete</i>Product deleted!</p>' });
        }
    }
    function addToCart() {
        M.toast({
            html: '<p><i class=\'material-icons right\'>add_shopping_cart</i>Added to cart!</p>'
        });
    }
</script>